# Content 
- [jwt structure](#jwt-structure)
- [Accepting arbitrary signatures](#accepting-arbitrary-signatures)
- [Accepting tokens with no signature](#accepting-tokens-with-no-signature)
- [Brute-forcing secret keys](#brute-forcing-secret-keys)
- [JWT header parameter injections](#jwt-header-parameter-injections)
  - [ Injecting self-signed JWTs via the jwk parameter](#injecting-self-signed-jwts-via-the-jwk-parameter)




## jwt structure
1) Header



| Header Parameter | Description                                             |
|------------------|---------------------------------------------------------|
| `alg`            | Algorithm used for signing/verifying the token (e.g., HS256).     |
| `typ`            | Type of the token (usually "JWT").                     |
| `cty`            | Content Type, indicating the media type of the token.  |
| `kid`            | Key ID, used to identify the key for verification.      |
| `jku`            | JSON Web Key Set URL, pointing to a set of keys.        |
|`jku`             | (JSON Web Key Set URL) - Provides a URL from which servers can fetch a set of keys containing the correct key. |



2) Payload
- Registered Claims


| Claim             | Description                                                |
|-------------------|------------------------------------------------------------|
| `iss` (Issuer)    | The entity that issued the JWT.                            |
| `sub` (Subject)   | The subject of the JWT, often a user ID.                   |
| `aud` (Audience)  | The intended audience for the JWT.                        |
| `exp` (Expiration) | The time after which the token should not be accepted.   |
| `nbf` (Not Before) | The time before which the token should not be accepted. |
| `iat` (Issued At) | The time at which the JWT was issued.                     |
| `jti` (JWT ID)     | A unique identifier for the token.                         |

- **Public claims:** are intended for use across different applications or by multiple parties.
- **Private Claims:** are specific to a particular application, organization, or use case, and their names are not required to follow standardized conventions.  

3) Signature


JWT token Example : 
```jwt
Header: {
  "alg": "HS256",
  "typ": "JWT"
}

Payload: {
  "iss": "example.com",
  "sub": "1234567890",
  "aud": "myapp",
  "exp": 1677648242,
  "nbf": 1677644642,
  "iat": 1677644642,
  "jti": "a1b2c3d4e5"
  // Custom claims:
  "username": "johndoe",
  "role": "admin"
}

Signature: (Generated using the HMAC-SHA256 algorithm)

```

## Accepting arbitrary signatures
- edit `sub` to another user ex:admin 
- sign the jwt token and send it

## Accepting tokens with no signature
- Setting the alg parameter to "none" is discouraged due to its inherent security risks. 
- Many servers reject unsigned tokens to prevent vulnerabilities. 
- This filtering is based on string parsing, making it possible to bypass such filters using obfuscation techniques like mixed capitalization and unexpected encodings.
```
None
none
NONE

```
## Brute-forcing secret keys
- [jwt secrets list](https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list)
```shell
hashcat -a 0 -m 16500 <jwt> <wordlist> --show

=> <jwt>:<identified-secret>
```


# JWT header parameter injections
## Injecting self-signed JWTs via the jwk parameter
